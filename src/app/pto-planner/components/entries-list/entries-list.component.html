<div class="card">
  <div class="row" style="justify-content:space-between; align-items:center; margin-bottom:10px">
    <h1 style="margin:0">All PTO Entries</h1>
    <button class="win-manage" routerLink="/planner">Back to Planner</button>
  </div>

  <div class="hint" style="margin-bottom:8px">Sorted by date (newest first). Edit inline and click Save, or Delete to remove.</div>

  <!-- Add entry -->
  <div class="row" style="gap:8px; align-items:center; margin:8px 0 4px">
    <input type="date" [ngModel]="newDate()" (ngModelChange)="newDate.set($event)"
           [attr.min]="store.yearStart()" [attr.max]="store.yearEndDisplay()" />
    <input type="number" step="0.01" style="max-width:120px" [ngModel]="newHours()" (ngModelChange)="newHours.set(+($event||0))" />
    <input type="text" placeholder="Note (optional)" style="flex:1" [ngModel]="newNote()" (ngModelChange)="newNote.set($event||'')" />
    <button class="win-manage" type="button" (click)="addEntryFromForm()">Add Entry</button>
  </div>
  <div class="hint">Date must be between {{ store.yearStart() }} and {{ store.yearEndDisplay() }} (inclusive).</div>

  <table id="windowsTable">
    <thead>
      <tr>
        <th style="width:140px">Date</th>
        <th style="width:120px">Hours</th>
        <th>Note</th>
        <th style="width:160px">Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let e of entries()">
        <td><input type="date" [(ngModel)]="e.date" /></td>
        <td><input type="number" step="0.01" [(ngModel)]="e.hours" /></td>
        <td><input type="text" [(ngModel)]="e.note" /></td>
        <td>
          <button class="icon-btn save" (click)="save(e)" aria-label="Save" title="Save">
            <svg viewBox="0 0 24 24" class="icon" aria-hidden="true">
              <rect x="3" y="3" width="18" height="18" rx="4" fill="none" stroke="currentColor" stroke-width="2"/>
              <path d="M12 7v7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <path d="M8 15h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <path d="M12 14l-3-3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M12 14l3-3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <button class="icon-btn del"
                  (mousedown)="startHold(e.id, $event)"
                  (mouseup)="cancelHold(e.id)"
                  (mouseleave)="cancelHold(e.id)"
                  (touchstart)="startHold(e.id, $event)"
                  (touchend)="cancelHold(e.id)"
                  (touchcancel)="cancelHold(e.id)"
                  [class.holding]="holding[e.id]"
                  [style.--p]="holdProgressPct(e.id)"
                  aria-label="Delete" title="Hold to delete">
            <svg viewBox="0 0 24 24" class="icon" aria-hidden="true">
              <path d="M4 7h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <path d="M9 7l1.2-2h3.6L15 7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <rect x="6" y="7" width="12" height="12" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
              <path d="M10 11v6m4-6v6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </td>
      </tr>
      <tr *ngIf="!entries().length">
        <td colspan="4" class="hint">No entries yet.</td>
      </tr>
    </tbody>
  </table>
</div>
